---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import propertiesData from '../../data/properties.json';
import PropertyDetailDefault from '../../components/property/detail/PropertyDetailDefault.astro';
import PropertyDetailVO from '../../components/property/detail/PropertyDetailVO.astro';

export async function getStaticPaths() {
  return propertiesData.map(property => ({
    params: { slug: property.slug },
    props: { property }
  }));
}

const { property } = Astro.props;

// Get site data for layout
const sites = await getCollection('sites');
const site = sites[0].data; // Use first site (hauptstadt)
const { meta } = site;

// Choose detail variant based on meta settings
const DetailComponent = meta.detailPageVariant === 'vo' ? PropertyDetailVO : PropertyDetailDefault;
---

<BaseLayout 
  title={`${property.title} | ${meta.brand.name}`}
  description={property.description}
  brand={meta.brand}
  contact={meta.contact}
  sectionStylePreset={meta.sectionStylePreset}
>
  <DetailComponent property={property} meta={meta} />
</BaseLayout>
