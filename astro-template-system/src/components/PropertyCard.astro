---
interface Props {
  property: {
    id: string;
    slug: string;
    type: string;
    status: string;
    title: string;
    location: {
      city: string;
      district: string;
    };
    price: {
      value: number;
      type: string;
      currency: string;
    };
    details: {
      area: number;
      rooms?: number;
      floor?: string;
    };
    features?: string[] | Array<{ icon: string; text: string }>;
    images: Array<{
      url: string;
      alt: string;
    }>;
  };
}

const { property } = Astro.props;

const formatPrice = (price: Props['property']['price']) => {
  if (price.type === 'kauf') {
    return `${price.currency} ${price.value.toLocaleString('de-DE')}`;
  }
  return `${price.currency} ${price.value.toLocaleString('de-DE')}/Monat`;
};

const getStatusLabel = (status: string) => {
  return status === 'kaufen' ? 'Zu verkaufen' : 'Zu vermieten';
};

const getTypeLabel = (type: string) => {
  const types: Record<string, string> = {
    wohnung: 'Wohnung',
    haus: 'Haus',
    gewerbe: 'Gewerbe',
    grundstueck: 'Grundstück'
  };
  return types[type] || type;
};
---

<a href={`/objekte/${property.slug}`} class="property-card">
  <div class="property-image">
    <img 
      src={property.images[0]?.url} 
      alt={property.images[0]?.alt || property.title}
      loading="lazy"
    />
    <div class="property-badges">
      <span class={`badge badge-${property.status}`}>
        {getStatusLabel(property.status)}
      </span>
      <span class="badge badge-type">
        {getTypeLabel(property.type)}
      </span>
    </div>
  </div>
  
  <div class="property-content">
    <h3 class="property-title">{property.title}</h3>
    
    <div class="property-location">
      <i class="fas fa-map-marker-alt"></i>
      <span>{property.location.district}, {property.location.city}</span>
    </div>

    <div class="property-details">
      <div class="property-detail">
        <i class="fas fa-ruler-combined"></i>
        <span>{property.details.area} m²</span>
      </div>
      {property.details.rooms && (
        <div class="property-detail">
          <i class="fas fa-door-open"></i>
          <span>{property.details.rooms} Zi.</span>
        </div>
      )}
      {property.details.floor && (
        <div class="property-detail">
          <i class="fas fa-building"></i>
          <span>{property.details.floor}</span>
        </div>
      )}
    </div>

    <div class="property-price">
      {formatPrice(property.price)}
    </div>
  </div>
</a>

<style>
  .property-card {
    background: var(--color-white);
    border-radius: var(--radius-lg);
    overflow: hidden;
    transition: var(--transition-smooth);
    text-decoration: none;
    color: inherit;
    display: block;
    box-shadow: var(--shadow-sm);
  }

  .property-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-lg);
  }

  .property-image {
    position: relative;
    height: 220px;
    overflow: hidden;
  }

  .property-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s ease;
  }

  .property-card:hover .property-image img {
    transform: scale(1.05);
  }

  .property-badges {
    position: absolute;
    top: var(--spacing-md);
    left: var(--spacing-md);
    display: flex;
    gap: var(--spacing-sm);
    flex-direction: column;
    align-items: flex-start;
  }

  .badge {
    padding: 0.35rem 0.75rem;
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    border-radius: var(--radius-sm);
  }

  .badge-kaufen {
    background: var(--color-accent);
    color: var(--color-white);
  }

  .badge-mieten {
    background: var(--color-success);
    color: var(--color-white);
  }

  .badge-type {
    background: var(--color-accent-light);
    color: var(--color-accent);
  }

  .property-content {
    padding: var(--spacing-lg);
  }

  .property-title {
    font-size: var(--text-lg);
    font-weight: 600;
    color: var(--color-primary);
    margin-bottom: var(--spacing-sm);
    line-height: 1.3;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .property-location {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    color: var(--color-text-light);
    font-size: var(--text-sm);
    margin-bottom: var(--spacing-md);
  }

  .property-location i {
    color: var(--color-accent);
  }

  .property-details {
    display: flex;
    gap: var(--spacing-lg);
    padding-top: var(--spacing-md);
    border-top: 1px solid var(--color-border);
    margin-bottom: var(--spacing-md);
  }

  .property-detail {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-size: var(--text-sm);
    color: var(--color-text-light);
  }

  .property-detail i {
    color: var(--color-accent);
  }

  .property-price {
    font-family: var(--font-display);
    font-size: var(--text-2xl);
    font-weight: 600;
    color: var(--color-accent);
  }
</style>
